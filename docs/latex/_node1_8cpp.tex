\hypertarget{_node1_8cpp}{}\doxysection{src/\+Node1.cpp File Reference}
\label{_node1_8cpp}\index{src/Node1.cpp@{src/Node1.cpp}}


This R\+OS node acts as an action client to communicate with an action server.\+A node that implements an action client, allowing the user to set a target (x, y) or to cancel it. Try to use the feedback/status of the action server to know when the target has been reached. The node also publishes the robot position and velocity as a custom message (x,y, vel\+\_\+x, vel\+\_\+z), by relying on the values published on the topic /odom.  


{\ttfamily \#include $<$ros/ros.\+h$>$}\newline
{\ttfamily \#include $<$actionlib/client/simple\+\_\+action\+\_\+client.\+h$>$}\newline
{\ttfamily \#include $<$nav\+\_\+msgs/\+Odometry.\+h$>$}\newline
{\ttfamily \#include \char`\"{}assignment\+\_\+2\+\_\+2024/\+Planning\+Action.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}assignment2\+\_\+rt/\+Robot\+Position.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}assignment2\+\_\+rt/\+Return\+Last\+Target.\+h\char`\"{}}\newline
Include dependency graph for Node1.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_node1_8cpp__incl}
\end{center}
\end{figure}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{_node1_8cpp_a19696c71eb339f4c4f361a92b2f36e2c}{target\+Callback}} (const assignment\+\_\+2\+\_\+2024\+::\+Planning\+Goal \&goal)
\begin{DoxyCompactList}\small\item\em This function is called when the user set a new target so it will update the 2 last\+\_\+target x and y and store them on the parameter server. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{_node1_8cpp_a486e61d150285226a22e43a6eb12fbd3}{odom\+Callback}} (const nav\+\_\+msgs\+::\+Odometry\+::\+Const\+Ptr \&msg, ros\+::\+Publisher pub)
\begin{DoxyCompactList}\small\item\em This functions extract the robot\textquotesingle{}s position and velocities from a message from Odometry data topic and publishes it as a custom message. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{_node1_8cpp_a1591e5d0f05c91b632f1d300894d8ff8}{get\+Last\+Target}} (assignment2\+\_\+rt\+::\+Return\+Last\+Target\+::\+Request \&req, assignment2\+\_\+rt\+::\+Return\+Last\+Target\+::\+Response \&res)
\begin{DoxyCompactList}\small\item\em Service callback that return last target set by users (it is a check if everything work fine). \end{DoxyCompactList}\item 
void \mbox{\hyperlink{_node1_8cpp_ac43a2f4d988dae38d694751ff2f94fc7}{state\+Callback}} (const actionlib\+::\+Simple\+Client\+Goal\+State \&state, const assignment\+\_\+2\+\_\+2024\+::\+Planning\+Result\+Const\+Ptr \&result)
\begin{DoxyCompactList}\small\item\em Callback for action result state. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{_node1_8cpp_a07489257e9d7710f7a53777c45111326}\label{_node1_8cpp_a07489257e9d7710f7a53777c45111326}} 
void \mbox{\hyperlink{_node1_8cpp_a07489257e9d7710f7a53777c45111326}{goal\+Callback}} ()
\begin{DoxyCompactList}\small\item\em Callback triggered when the goal becomes active. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{_node1_8cpp_a401f40edd1416d1afb74a9d787a1cbf5}{feedback\+Callback}} (const assignment\+\_\+2\+\_\+2024\+::\+Planning\+Feedback\+Const\+Ptr \&feedback)
\begin{DoxyCompactList}\small\item\em Callback for action feedback. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{_node1_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{main}} (int argc, char $\ast$$\ast$argv)
\begin{DoxyCompactList}\small\item\em Main function to initialize the R\+OS node and handle user input. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_node1_8cpp_a0227367c071fffbf604044ee6d73cb17}\label{_node1_8cpp_a0227367c071fffbf604044ee6d73cb17}} 
float {\bfseries last\+\_\+x\+\_\+target} = 0.\+0
\item 
\mbox{\Hypertarget{_node1_8cpp_a9d15ecee4575fb9db59b42866113c25d}\label{_node1_8cpp_a9d15ecee4575fb9db59b42866113c25d}} 
float {\bfseries last\+\_\+y\+\_\+target} = 0.\+0
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This R\+OS node acts as an action client to communicate with an action server.\+A node that implements an action client, allowing the user to set a target (x, y) or to cancel it. Try to use the feedback/status of the action server to know when the target has been reached. The node also publishes the robot position and velocity as a custom message (x,y, vel\+\_\+x, vel\+\_\+z), by relying on the values published on the topic /odom. 

\begin{DoxyAuthor}{Author}
Filippo Salterini 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
31/03/2025
\end{DoxyDate}
Subscribes to\+: /odom (nav\+\_\+msgs\+::\+Odometry)\+: Receives the robot\textquotesingle{}s position and velocity. Publishes to\+: /robot\+\_\+position (assignment2\+\_\+rt\+::\+Robot\+Position)\+: Publishes the robot\textquotesingle{}s position and velocity. Provides Services\+: /get\+\_\+last\+\_\+target (assignment2\+\_\+rt\+::\+Return\+Last\+Target)\+: Returns the last target set. Uses Action Clients\+: /reaching\+\_\+goal (assignment\+\_\+2\+\_\+2024\+::\+Planning\+Action)\+: Sends a goal to the robot.

Description\+: A node that implements an action client, allowing the user to set a target (x, y) or to cancel it. Try to use the feedback/status of the action server to know when the target has been reached. The node also publishes the robot position and velocity as a custom message (x,y, vel\+\_\+x, vel\+\_\+z), by relying on the values published on the topic /odom. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{_node1_8cpp_a401f40edd1416d1afb74a9d787a1cbf5}\label{_node1_8cpp_a401f40edd1416d1afb74a9d787a1cbf5}} 
\index{Node1.cpp@{Node1.cpp}!feedbackCallback@{feedbackCallback}}
\index{feedbackCallback@{feedbackCallback}!Node1.cpp@{Node1.cpp}}
\doxysubsubsection{\texorpdfstring{feedbackCallback()}{feedbackCallback()}}
{\footnotesize\ttfamily void feedback\+Callback (\begin{DoxyParamCaption}\item[{const assignment\+\_\+2\+\_\+2024\+::\+Planning\+Feedback\+Const\+Ptr \&}]{feedback }\end{DoxyParamCaption})}



Callback for action feedback. 


\begin{DoxyParams}{Parameters}
{\em feedback} & The feedback message containing the current position. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{_node1_8cpp_a1591e5d0f05c91b632f1d300894d8ff8}\label{_node1_8cpp_a1591e5d0f05c91b632f1d300894d8ff8}} 
\index{Node1.cpp@{Node1.cpp}!getLastTarget@{getLastTarget}}
\index{getLastTarget@{getLastTarget}!Node1.cpp@{Node1.cpp}}
\doxysubsubsection{\texorpdfstring{getLastTarget()}{getLastTarget()}}
{\footnotesize\ttfamily bool get\+Last\+Target (\begin{DoxyParamCaption}\item[{assignment2\+\_\+rt\+::\+Return\+Last\+Target\+::\+Request \&}]{req,  }\item[{assignment2\+\_\+rt\+::\+Return\+Last\+Target\+::\+Response \&}]{res }\end{DoxyParamCaption})}



Service callback that return last target set by users (it is a check if everything work fine). 


\begin{DoxyParams}{Parameters}
{\em req} & The service request. \\
\hline
{\em res} & The service response containing the last target coordinates. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always true. 
\end{DoxyReturn}
\mbox{\Hypertarget{_node1_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}\label{_node1_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}} 
\index{Node1.cpp@{Node1.cpp}!main@{main}}
\index{main@{main}!Node1.cpp@{Node1.cpp}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$$\ast$}]{argv }\end{DoxyParamCaption})}



Main function to initialize the R\+OS node and handle user input. 

$<$ Initialize the R\+OS node with the name \char`\"{}\+Node1\char`\"{}.

Create an action client to communicate with the \char`\"{}reaching\+\_\+goal\char`\"{} action server.

Create a publisher to publish the robot\textquotesingle{}s position on the \char`\"{}robot\+\_\+position\char`\"{} topic.

Subscribe to the \char`\"{}/odom\char`\"{} topic to receive odometry data. 
\begin{DoxyParams}{Parameters}
{\em msg} & The odometry message.\\
\hline
\end{DoxyParams}
Advertise a service to return the last target set by the user.

$<$ Set the loop rate to 10 Hz.

Main loop\+: keeps running as long as R\+OS is active.

User selects to set a new target.

The user is prompted to enter the target coordinates (x, y). A goal message is created and sent to the action server.

$<$ Read target coordinates from user input.

Send the goal to the action server. 
\begin{DoxyParams}{Parameters}
{\em goal} & The goal message containing target coordinates.\\
\hline
\end{DoxyParams}
Update the last known target. 
\begin{DoxyParams}{Parameters}
{\em goal} & The goal message containing target coordinates.\\
\hline
\end{DoxyParams}
User selects to cancel the current goal.

The goal is canceled by calling the cancel\+Goal() function.

Handle invalid user input.\mbox{\Hypertarget{_node1_8cpp_a486e61d150285226a22e43a6eb12fbd3}\label{_node1_8cpp_a486e61d150285226a22e43a6eb12fbd3}} 
\index{Node1.cpp@{Node1.cpp}!odomCallback@{odomCallback}}
\index{odomCallback@{odomCallback}!Node1.cpp@{Node1.cpp}}
\doxysubsubsection{\texorpdfstring{odomCallback()}{odomCallback()}}
{\footnotesize\ttfamily void odom\+Callback (\begin{DoxyParamCaption}\item[{const nav\+\_\+msgs\+::\+Odometry\+::\+Const\+Ptr \&}]{msg,  }\item[{ros\+::\+Publisher}]{pub }\end{DoxyParamCaption})}



This functions extract the robot\textquotesingle{}s position and velocities from a message from Odometry data topic and publishes it as a custom message. 


\begin{DoxyParams}{Parameters}
{\em msg} & The received odometry message. \\
\hline
{\em pub} & The publisher to publish robot position and velocity. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{_node1_8cpp_ac43a2f4d988dae38d694751ff2f94fc7}\label{_node1_8cpp_ac43a2f4d988dae38d694751ff2f94fc7}} 
\index{Node1.cpp@{Node1.cpp}!stateCallback@{stateCallback}}
\index{stateCallback@{stateCallback}!Node1.cpp@{Node1.cpp}}
\doxysubsubsection{\texorpdfstring{stateCallback()}{stateCallback()}}
{\footnotesize\ttfamily void state\+Callback (\begin{DoxyParamCaption}\item[{const actionlib\+::\+Simple\+Client\+Goal\+State \&}]{state,  }\item[{const assignment\+\_\+2\+\_\+2024\+::\+Planning\+Result\+Const\+Ptr \&}]{result }\end{DoxyParamCaption})}



Callback for action result state. 


\begin{DoxyParams}{Parameters}
{\em state} & The final state of the action. \\
\hline
{\em result} & The result returned by the action. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{_node1_8cpp_a19696c71eb339f4c4f361a92b2f36e2c}\label{_node1_8cpp_a19696c71eb339f4c4f361a92b2f36e2c}} 
\index{Node1.cpp@{Node1.cpp}!targetCallback@{targetCallback}}
\index{targetCallback@{targetCallback}!Node1.cpp@{Node1.cpp}}
\doxysubsubsection{\texorpdfstring{targetCallback()}{targetCallback()}}
{\footnotesize\ttfamily void target\+Callback (\begin{DoxyParamCaption}\item[{const assignment\+\_\+2\+\_\+2024\+::\+Planning\+Goal \&}]{goal }\end{DoxyParamCaption})}



This function is called when the user set a new target so it will update the 2 last\+\_\+target x and y and store them on the parameter server. 


\begin{DoxyParams}{Parameters}
{\em goal} & The goal received, containing the target coordinates. \\
\hline
\end{DoxyParams}
